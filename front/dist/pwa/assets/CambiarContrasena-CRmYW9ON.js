import{Q as u}from"./QSpace-D9phzHsB.js";import{_ as p,c,o as f,w as t,b as a,a as r,Q as w,e as d,d as b,J as v,ao as y,ag as n,f as l}from"./index-BCqWixgG.js";import{Q as g}from"./QBanner-B_-Jc-wH.js";import{Q as C}from"./QForm-BYazywih.js";import{Q as h}from"./QPage-CCnFDat8.js";const _={name:"CambiarContrasena",data(){return{loading:!1,showCurrent:!1,showNew:!1,showConfirm:!1,form:{current_password:"",password:"",password_confirmation:""}}},methods:{async submit(){this.loading=!0;try{await this.$axios.post("/me/password",this.form),this.$alert.success("Contraseña actualizada. Inicia sesión nuevamente."),this.$store.isLogged=!1,this.$store.user={},this.$store.permissions=[],localStorage.removeItem("tokenSIL"),this.$router.push("/login")}catch(i){this.$alert.error(i.response?.data?.message||"No se pudo cambiar la contraseña")}finally{this.loading=!1}}}},Q={class:"row justify-center"},x={class:"col-12 col-md-6"},V={class:"row q-col-gutter-sm"},N={class:"col-12 col-sm-6"},k={class:"col-12 col-sm-6"};function q(i,e,S,B,s,m){return f(),c(h,{class:"q-pa-md bg-grey-2"},{default:t(()=>[a("div",Q,[a("div",x,[r(w,{flat:"",bordered:""},{default:t(()=>[r(d,{class:"row items-center q-py-sm"},{default:t(()=>[e[7]||(e[7]=a("div",null,[a("div",{class:"text-h6 text-weight-bold"},"Cambiar contraseña"),a("div",{class:"text-caption text-grey-7"}," Al guardar se cerrarán todas las sesiones (incluyéndote). ")],-1)),r(u),r(b,{name:"vpn_key",color:"primary",size:"28px"})]),_:1}),r(v),r(d,{class:"q-pa-md"},{default:t(()=>[r(C,{onSubmit:y(m.submit,["prevent"])},{default:t(()=>[r(n,{modelValue:s.form.current_password,"onUpdate:modelValue":e[1]||(e[1]=o=>s.form.current_password=o),dense:"",outlined:"",type:s.showCurrent?"text":"password",label:"Contraseña actual",autocomplete:"current-password",class:"q-mb-sm",rules:[o=>!!o||"Requerido"]},{append:t(()=>[r(l,{dense:"",flat:"",round:"",icon:s.showCurrent?"visibility":"visibility_off",onClick:e[0]||(e[0]=o=>s.showCurrent=!s.showCurrent)},null,8,["icon"])]),_:1},8,["modelValue","type","rules"]),r(n,{modelValue:s.form.password,"onUpdate:modelValue":e[3]||(e[3]=o=>s.form.password=o),dense:"",outlined:"",type:s.showNew?"text":"password",label:"Nueva contraseña",autocomplete:"new-password",class:"q-mb-sm",rules:[o=>o&&o.length>=6||"Mínimo 6 caracteres"]},{append:t(()=>[r(l,{dense:"",flat:"",round:"",icon:s.showNew?"visibility":"visibility_off",onClick:e[2]||(e[2]=o=>s.showNew=!s.showNew)},null,8,["icon"])]),_:1},8,["modelValue","type","rules"]),r(n,{modelValue:s.form.password_confirmation,"onUpdate:modelValue":e[5]||(e[5]=o=>s.form.password_confirmation=o),dense:"",outlined:"",type:s.showConfirm?"text":"password",label:"Confirmar nueva contraseña",autocomplete:"new-password",class:"q-mb-md",rules:[o=>!!o||"Requerido",o=>o===s.form.password||"No coincide"]},{append:t(()=>[r(l,{dense:"",flat:"",round:"",icon:s.showConfirm?"visibility":"visibility_off",onClick:e[4]||(e[4]=o=>s.showConfirm=!s.showConfirm)},null,8,["icon"])]),_:1},8,["modelValue","type","rules"]),r(g,{dense:"",class:"bg-grey-1 q-mb-md"},{default:t(()=>[...e[8]||(e[8]=[a("div",{class:"text-caption text-grey-7"}," Nota: al cambiar la contraseña, se eliminarán todos los tokens de Sanctum para evitar sesiones abiertas. ",-1)])]),_:1}),a("div",V,[a("div",N,[r(l,{class:"full-width","no-caps":"",color:"primary",icon:"save",label:"Guardar",type:"submit",loading:s.loading},null,8,["loading"])]),a("div",k,[r(l,{class:"full-width","no-caps":"",flat:"",color:"grey-8",icon:"arrow_back",label:"Volver",onClick:e[6]||(e[6]=o=>i.$router.push("/")),disable:s.loading},null,8,["disable"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1})}const R=p(_,[["render",q]]);export{R as default};
