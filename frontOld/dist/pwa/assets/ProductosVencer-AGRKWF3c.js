import{_,c as u,o as c,w as l,a as t,Q as b,e as v,b as e,aa as x,d as P,ar as Q,as as C,f as w,a1 as y,a3 as m,a4 as S,a5 as k,t as n,a2 as p}from"./index-CmoW1HI-.js";import{Q as N}from"./QPagination-CYKlUxbO.js";import{Q as g}from"./QBadge-CyZorIy0.js";import{Q as q}from"./QMarkupTable-6CKuV8-r.js";import{Q as M}from"./QPage-Dl-a7fNa.js";import{h}from"./moment-C5S46NFB.js";import"./format-CJebrXOQ.js";const B={name:"ProductosPorVencer",data(){return{dias:30,diasSelect:"Dias",productos:[],loading:!1,pagination:{page:1,rowsPerPage:10,rowsNumber:0}}},mounted(){this.consultar()},methods:{consultar(){this.loading=!0;const d=this.diasSelect==="Dias"?this.dias:this.dias*(this.diasSelect==="Semanas"?7:this.diasSelect==="Meses"?30:365);this.$axios.get("/productosPorVencer",{params:{dias:d,page:this.pagination.page,perPage:this.pagination.rowsPerPage}}).then(a=>{this.productos=a.data.data,this.pagination.rowsNumber=a.data.total}).catch(()=>{this.$alert.error("Error al consultar productos por vencer")}).finally(()=>{this.loading=!1})},diasRestantesColor(d){const a=h(),r=h(d).diff(a,"days"),o=Math.ceil(this.dias/3);return r<=o?{color:"red",dias:r}:r<=o*2?{color:"orange",dias:r}:{color:"green",dias:r}}}},D={class:"row"},U={class:"col-12 col-md-2"},R={class:"col-12 col-md-4 q-pa-xs"},A={class:"col-12 col-md-2"},E={class:"flex flex-center"};function F(d,a,f,r,o,i){return c(),u(M,{class:"q-pa-xs"},{default:l(()=>[t(b,{flat:"",bordered:""},{default:l(()=>[t(v,{class:"q-pa-xs"},{default:l(()=>[a[5]||(a[5]=e("div",{class:"text-h6"},"Productos por Vencer",-1)),e("div",D,[e("div",U,[t(x,{type:"number",modelValue:o.dias,"onUpdate:modelValue":a[1]||(a[1]=s=>o.dias=s),outlined:"",dense:"",label:"Número de días",min:"1",max:"365",onChange:i.consultar},{append:l(()=>[t(P,{name:"calendar_today",class:"cursor-pointer",onClick:a[0]||(a[0]=Q(()=>{},["stop"]))})]),_:1},8,["modelValue","onChange"])]),e("div",R,[t(C,{modelValue:o.diasSelect,"onUpdate:modelValue":[a[2]||(a[2]=s=>o.diasSelect=s),i.consultar],dense:"",inline:"",options:[{label:"Días",value:"Dias"},{label:"Semanas",value:"Semanas"},{label:"Meses",value:"Meses"},{label:"Año",value:"Año"}],color:"primary"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",A,[t(w,{label:"Consultar",color:"green",icon:"search",onClick:i.consultar,loading:o.loading,"no-caps":""},null,8,["onClick","loading"])])]),e("div",E,[o.pagination.rowsNumber>o.pagination.rowsPerPage?(c(),u(N,{key:0,modelValue:o.pagination.page,"onUpdate:modelValue":[a[3]||(a[3]=s=>o.pagination.page=s),i.consultar],max:Math.ceil(o.pagination.rowsNumber/o.pagination.rowsPerPage),color:"primary",class:"q-mt-md"},null,8,["modelValue","max","onUpdate:modelValue"])):y("",!0)]),t(q,{dense:"",class:"q-mt-md",flat:"",bordered:""},{default:l(()=>[a[4]||(a[4]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"Producto"),e("th",null,"Cantidad"),e("th",null,"Lote"),e("th",null,"Fecha de Vencimiento"),e("th",null,"Estado"),e("th",null,"Días restantes")])],-1)),e("tbody",null,[(c(!0),m(S,null,k(o.productos,(s,V)=>(c(),m("tr",{key:s.id},[e("td",null,n(V+1),1),e("td",null,n(s.producto?.nombre),1),e("td",null,n(s.cantidad),1),e("td",null,n(s.lote),1),e("td",null,n(s.fecha_vencimiento),1),e("td",null,[t(g,{color:s.estado==="Activo"?"green":"red",class:"q-pa-xs"},{default:l(()=>[p(n(s.estado),1)]),_:2},1032,["color"])]),e("td",null,[t(g,{color:i.diasRestantesColor(s.fecha_vencimiento).color,class:"q-pa-xs"},{default:l(()=>[p(n(i.diasRestantesColor(s.fecha_vencimiento).dias)+" días ",1)]),_:2},1032,["color"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})}const H=_(B,[["render",F]]);export{H as default};
