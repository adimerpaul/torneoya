import{_ as c,c as h,o as m,w as i,a as r,Q as p,e as v,b as d,f as u,aa as n,d as b,a3 as f,a4 as V,a5 as P,t as s,h as C}from"./index-CmoW1HI-.js";import{Q as k}from"./QMarkupTable-6CKuV8-r.js";import{Q}from"./QForm-I0BS1mnk.js";import{Q as x}from"./QPage-Dl-a7fNa.js";const y={name:"ProveedoresPage",data(){return{proveedores:[],proveedoresFiltrados:[],proveedor:{},filtro:"",dialog:!1,loading:!1}},mounted(){this.obtenerProveedores()},methods:{obtenerProveedores(){this.loading=!0,this.$axios.get("proveedores").then(t=>{this.proveedores=t.data,this.filtrarProveedores()}).finally(()=>{this.loading=!1})},filtrarProveedores(){const t=this.filtro.toLowerCase();this.proveedoresFiltrados=this.proveedores.filter(e=>e.nombre.toLowerCase().includes(t)||e.email&&e.email.toLowerCase().includes(t))},nuevoProveedor(){this.proveedor={},this.dialog=!0},editarProveedor(t){this.proveedor={...t},this.dialog=!0},guardarProveedor(){this.loading=!0,(this.proveedor.id?this.$axios.put(`proveedores/${this.proveedor.id}`,this.proveedor):this.$axios.post("proveedores",this.proveedor)).then(()=>{this.dialog=!1,this.obtenerProveedores(),this.$alert.success("Proveedor guardado")}).catch(e=>{this.$alert.error(e.response?.data?.message||"Error al guardar")})},eliminarProveedor(t){this.$alert.dialog("¿Desea eliminar este proveedor?").onOk(()=>{this.$axios.delete(`proveedores/${t}`).then(()=>{this.obtenerProveedores(),this.$alert.success("Proveedor eliminado")}).catch(e=>{this.$alert.error(e.response?.data?.message||"Error al eliminar")})})}}},U={class:"row items-center q-gutter-sm"},w={class:"text-h6"},_={class:"text-right q-mt-sm"};function q(t,e,B,E,l,a){return m(),h(x,{class:"q-pa-md"},{default:i(()=>[r(p,{flat:"",bordered:""},{default:i(()=>[r(v,null,{default:i(()=>[d("div",U,[r(u,{label:"Nuevo Proveedor",color:"positive",onClick:a.nuevoProveedor,"no-caps":"",icon:"add",loading:l.loading},null,8,["onClick","loading"]),r(n,{modelValue:l.filtro,"onUpdate:modelValue":[e[0]||(e[0]=o=>l.filtro=o),a.filtrarProveedores],label:"Buscar proveedor",debounce:"300",outlined:"",dense:""},{append:i(()=>[r(b,{name:"search"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),r(k,{dense:"",class:"q-mt-sm",flat:"",bordered:""},{default:i(()=>[e[8]||(e[8]=d("thead",null,[d("tr",null,[d("th",null,"Acciones"),d("th",null,"Nombre"),d("th",null,"CI"),d("th",null,"Teléfono"),d("th",null,"Dirección"),d("th",null,"Email")])],-1)),d("tbody",null,[(m(!0),f(V,null,P(l.proveedoresFiltrados,o=>(m(),f("tr",{key:o.id},[d("td",null,[r(u,{icon:"edit",flat:"",dense:"",onClick:g=>a.editarProveedor(o),loading:l.loading},null,8,["onClick","loading"]),r(u,{icon:"delete",flat:"",dense:"",color:"negative",onClick:g=>a.eliminarProveedor(o.id),loading:l.loading},null,8,["onClick","loading"])]),d("td",null,s(o.nombre),1),d("td",null,s(o.ci),1),d("td",null,s(o.telefono),1),d("td",null,s(o.direccion),1),d("td",null,s(o.email),1)]))),128))])]),_:1})]),_:1})]),_:1}),r(C,{modelValue:l.dialog,"onUpdate:modelValue":e[7]||(e[7]=o=>l.dialog=o)},{default:i(()=>[r(p,{style:{width:"400px"}},{default:i(()=>[r(v,null,{default:i(()=>[d("div",w,s(l.proveedor.id?"Editar":"Nuevo")+" Proveedor",1)]),_:1}),r(v,null,{default:i(()=>[r(Q,{onSubmit:a.guardarProveedor},{default:i(()=>[r(n,{modelValue:l.proveedor.nombre,"onUpdate:modelValue":e[1]||(e[1]=o=>l.proveedor.nombre=o),label:"Nombre",outlined:"",dense:"",rules:[o=>!!o||"Campo requerido"]},null,8,["modelValue","rules"]),r(n,{modelValue:l.proveedor.ci,"onUpdate:modelValue":e[2]||(e[2]=o=>l.proveedor.ci=o),label:"CI",outlined:"",dense:""},null,8,["modelValue"]),r(n,{modelValue:l.proveedor.telefono,"onUpdate:modelValue":e[3]||(e[3]=o=>l.proveedor.telefono=o),label:"Teléfono",outlined:"",dense:""},null,8,["modelValue"]),r(n,{modelValue:l.proveedor.direccion,"onUpdate:modelValue":e[4]||(e[4]=o=>l.proveedor.direccion=o),label:"Dirección",outlined:"",dense:""},null,8,["modelValue"]),r(n,{modelValue:l.proveedor.email,"onUpdate:modelValue":e[5]||(e[5]=o=>l.proveedor.email=o),label:"Email",outlined:"",dense:"",type:"email"},null,8,["modelValue"]),d("div",_,[r(u,{label:"Cancelar",flat:"",onClick:e[6]||(e[6]=o=>l.dialog=!1),loading:l.loading},null,8,["loading"]),r(u,{label:"Guardar",color:"primary",type:"submit",class:"q-ml-sm",loading:l.loading},null,8,["loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const L=c(y,[["render",q]]);export{L as default};
